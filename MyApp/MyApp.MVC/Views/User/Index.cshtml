@{
  Layout = null;
}
<!DOCTYPE html>
<html>

<head>
  <!--meta tags-->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

  <title>Clarent Institute CorePocket</title>
  <!-- favicon -->
  <!--<link rel="shortcut icon" href="../../App_Themes/Default/images/favicon.ico" type="image/x-icon">-->

  <link href="../../App_Themes/Default/css/kendo.common.min.css" rel="stylesheet" />
  <link href="../../App_Themes/Default/css/kendo.default.min.css" rel="stylesheet" />
  <link href="../../App_Themes/Default/css/fonts.css" rel="stylesheet" />
  <link href="../../App_Themes/Default/css/styleguide.css" rel="stylesheet" />
  <link href="../../App_Themes/Default/css/core-pocket-responsive.css" rel="stylesheet" />
  <link href="../../App_Themes/Default/css/casepoint.comfortable.css" rel="stylesheet" />
  <link href="../../App_Themes/Default/css/kendo.Deeppurple.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

  <!-- css -->
  <link href="../../App_Themes/Default/css/core-pocket.css" rel="stylesheet" />
</head>

<body>
  <!-- BEGIN LOADER -->
  <div id="load_screen" class="load-screen">
    <div class="pre-loader">
      <div class="loader-content">
        <h5 class="text-primary">TaskTrackPro</h5>
        <button>
          <div class="spinner-border mr-2 align-self-center loader-sm"></div>
          <span>Loading...</span>
        </button>
      </div>
    </div>
  </div>
  <!--  END LOADER -->

  <!-- header -->
  <header class="main-header">
    <nav class="mt-navbar">
      <div class="nav-left" id="dvLeftMenu" data-role="aratooltipv2">
        <div class="logo-wrapper">
          <img src="../../App_Themes/Default/images/Clarent_White_Logo.svg" />
        </div>
        <ul class="left-menu list-unstyled list-inline">
          <li class="separator"></li>
          <li class="active project-item">
            <a class="noPointer ellipsis" title="TaskTrackPro">TaskTrackPro</a>
          </li>
        </ul>
      </div>
      <div class="nav-right">
        <ul class="user-menu">
          <li class="support-mail-wrapper">
            <a href="javascript:void(0)" class="help">
              <span class="icon"><i class="icon-help"></i></span>
            </a>
          </li>
          <li class="notification-item item">
            <a href="javascript:void(0)">
              <span class="icon"><i class="icon-notification"></i></span>
              <!-- here we need to give notification -->
              <span class="counts">12</span>
            </a>
          </li>
          <li class="separator"></li>
          <li class="userprofile-item userprofile dropdown">
            <a href="javascript:void(0)">
              <!-- here the logged in users Details -->
              <span class="navuser-ellipse" id="lblusername1"></span>
              <span class="dw-icon"><i class="icon-arrow-down"></i></span>
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </header>
  <!-- #header -->
  <!--navigation pages-->
  <nav class="mt-navbar-pages">
    <ul class="list-inline pages-menu">
      <li class="active">
        <a href="dashboard.html" title="Dashboard">Dashboard</a>
      </li>
      <li><a asp-controller="User" asp-action="Chat" title="Chat">Chat</a></li>
    </ul>
  </nav>
  <!--#navigation pages-->

  <!-- user profile -->
  <div class="userprofile-menu dropdown-menu">
    <div class="usermenu-wrap">
      <div class="main-up">
        <div class="userprofile-content">
          <div class="brief">
            <div class="profileLetterDiv img-circle"><span id="imguser"></span></div>
            <div class="ImgDiv img-circle" id="ViewDiv"><img id="ViewProfileImage" /></div>
          </div>
          <div class="a-box">
            <a id="settings"><i class="icon-setting"></i><span class="text-dark text-semibold">Settings</span></a>
            <a href="../Login.html" class="bl-0"><i class="icon-logout text-danger"></i><span
                class="text-dark text-semibold">Logout</span></a>
          </div>
          <div class="bottom-block">
            <div class="userprofile-info d-flex align-items-center">
              <span class="userprofile-info-icon"><i class="icon-user"></i></span>
              <div class="flex-1 overflow-hidden font-semi-bold ml-15">
                <span class="text-muted d-block ellipsis mb-5">Username</span>
                <span class="text-dark d-block ellipsis fs-15" id="lblusername"></span>
              </div>
            </div>
            <div class="userprofile-info d-flex align-items-center">
              <span class="userprofile-info-icon"><i class="icon-email"></i></span>
              <div class="flex-1 overflow-hidden font-semi-bold ml-15">
                <span class="text-muted d-block ellipsis mb-5">Email</span>
                <span class="text-dark d-block ellipsis fs-15" id="lblemail"></span>
              </div>
            </div>

            <div class="userprofile-info d-flex align-items-center">
              <span class="userprofile-info-icon"><i class="icon-mobile"></i></span>
              <div class="flex-1 overflow-hidden font-semi-bold ml-15">
                <span class="text-muted d-block ellipsis mb-5">Phone Number</span>
                <span class="text-dark d-block ellipsis fs-15" id="lblmobile"></span>
              </div>
            </div>

            <div class="userprofile-info d-flex align-items-center">
              <span class="userprofile-info-icon"><i class="icon-location"></i></span>
              <div class="flex-1 overflow-hidden font-semi-bold ml-15">
                <span class="text-muted d-block ellipsis mb-5">Address</span>
                <span class="text-dark d-block ellipsis fs-15" id="lbladdress"></span>
              </div>
            </div>
            <div class="userprofile-info d-flex align-items-center">
              <span class="userprofile-info-icon"><i class="bi bi-gender-ambiguous"></i></span>
              <div class="flex-1 overflow-hidden font-semi-bold ml-15">
                <span class="text-muted d-block ellipsis mb-5">Gender</span>
                <span class="text-dark d-block ellipsis fs-15" id="lblgender"></span>
              </div>
            </div>

            <div class="userprofile-info d-flex align-items-center">
              <span class="userprofile-info-icon"><i class="icon-assign-role"></i></span>
              <div class="flex-1 overflow-hidden font-semi-bold ml-15">
                <span class="text-muted d-block ellipsis mb-5">User Role</span>
                <span class="text-dark d-block ellipsis fs-15" id="lblrole"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="settings">
        <div class="head">
          <a class="back"><i class="icon-arrow-left"></i></a>
          <h3>Settings</h3>
        </div>
        <!-- tab strip -->
        <div id="tabstrip" class="h100">
          <ul>
            <li class="k-state-active">Edit Profile</li>
            <li>Change Password</li>
          </ul>
          <div>
            <div class="setting-footer">
              <a class="btn btn-trans close" id="btnCloseprofile">Close</a>
              <a class="btn btn-trans ml-0" id="btnResetprofile" onclick="resetEventProfile()">Reset</a>
              <a class="btn btn-primary" id="btnUpdateprofile" onclick="validateDetails()">Update</a>
            </div>

            <!-- ========== Edit Profile Section ========== -->

            <form class="edit-profile" method="post" enctype="multipart/form-data">
              <div class="brief">
                <div class="ImgDiv img-circle" id="EditDiv"><img id="EditProfileImage" /></div>
                <span class="input-pic">
                  <input type="file" id="fileProfileImage" name="fileProfileImage" title="Change Photo"
                    onchange="previewImage()" style="display: none;color:#7E57C2">
                  <label for="fileProfileImage" class="file-input-label">
                    <i class="icon-photo"></i> Change Photo
                  </label>
                </span>

                <a onclick="ResetProfile();"><i class="icon-delete"></i>Reset Photo</a>
              </div>

              <div class="edit-profile-details">
                <div class="form-group">
                  <input class="form-control" type="hidden" value="" id="userid" />
                </div>
                <div class="form-group">
                  <label>User Name</label>
                  <input class="form-control" type="text" value="" id="txtuname" onkeyup="validateUserName()" />
                  <span id="userNameValidateMessage"></span>
                </div>

                <div class="form-group">
                  <label>Email</label>
                  <input class="form-control" type="email" readonly value="" id="txtemail" />
                </div>
                <div class="form-group">
                  <label>Phone Number</label>
                  <input class="form-control" type="text" value="" id="txtmobile" onkeyup="validateMobileNumber()" />
                  <span id="mobileValidateMessage"></span>
                </div>
                <div class="form-group">
                  <label>Address</label>
                  <input class="form-control" type="text" value="" id="txtaddress" onkeyup="validateAddress()" />
                  <span id="addressValidateMessage"></span>
                </div>
              </div>
            </form>
          </div>

          <div>
            <div>
              <!-- changepassword-->
              <form class="edit-profile">
                <div class="edit-profile-details">

                  <div class="form-group" style="position: relative;">
                    <label>Current Password</label>
                    <div style="position: relative;">
                      <input class="form-control" type="password" placeholder="Current Password" id="txtOldPassword"
                        onkeyup="validateCurrentPassword()" onchange="return validateCurrentPassword()"
                        style="padding-right: 30px; /* Adjust the padding-right to create space for the icon */" />
                      <span class="login-textbox-icon"
                        style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%);">
                        <i class="k-icon k-i-eye toggle-password1" aria-hidden="true"
                          onclick="togglePasswordVisibility()"></i>
                      </span>
                    </div>
                    <span id="oldpasswordValidateMessage"></span>
                  </div>
                  <div class="form-group">
                    <label>New Password</label>
                    <div style="position: relative;">
                      <input class="form-control" type="password" placeholder="New Password" id="txtNewPassword"
                        onkeyup="validateNewPassword()"
                        style="padding-right: 30px; /* Adjust the padding-right to create space for the icon */" />
                      <span class="login-textbox-icon"
                        style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%);">
                        <i class="k-icon k-i-eye toggle-password2" aria-hidden="true"
                          onclick="togglePasswordVisibility1()"></i>
                      </span>
                    </div>
                    <span id="newpasswordValidateMessage"></span>
                  </div>
                  <div class="form-group">
                    <label>Confirm Password</label>
                    <div style="position: relative;">
                      <input class="form-control" type="password" placeholder="Re-type New Password"
                        id="txtConfirmPassword" onkeyup="validateConfirmPassword()"
                        style="padding-right: 30px; /* Adjust the padding-right to create space for the icon */" />
                      <span class="login-textbox-icon"
                        style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%);">
                        <i class="k-icon k-i-eye toggle-password3" aria-hidden="true"
                          onclick="togglePasswordVisibility2()"></i>
                      </span>
                    </div>
                    <span id="copasswordValidateMessage"></span>
                  </div>
                </div>
              </form>
            </div>
            <div id="notification" style="display: none; color: green; margin-top: 10px;"></div>
            <div class="setting-footer">
              <a class="btn btn-trans close" id="btnClose">Close</a>
              <a class="btn btn-trans ml-0" id="btnReset" onclick="resetEvent()">Reset</a>
              <a class="btn btn-primary" id="btnSave" onclick="validatePassword()">Save</a>
            </div>        
          </div>
        </div>        
      </div>
    </div>
  </div>

<div class="notification-box success" id="user-update-notification" style="display: block;">
    <div class="notification-alert success user-update">
      <div class="pull-left"><i class="icon-check" aria-hidden="true"></i></div>
      <div class="pull-right" role="alert" aria-label="Success">
      </div>
    </div>
  </div>

  <!-- end user profile -->
  <!-- main content -->
  <div class="main-content">
    <!-- here will be my main content -->
    @* <iframe
        id="iframe"
        style="height: 100%; width: 100%"
        tabindex="0"
        src="./dashboard-iframe.html"
      ></iframe> *@
    <p>this is dashboard section</p>
    <div id="taskList"></div>
  </div>
  <!-- ##end main content -->
  <!-- footer -->
  <footer class="main-footer">
    <div class="footer-wrap">
      <div class="login-wrap">
        Login Time: <span>02-18-2019 15:12:43</span>
      </div>
      <div class="version-wrap"><span>Casepoint v1.0.0.0</span></div>
    </div>
  </footer>
  <!-- footer -->
  <script type="text/x-kendo-template" id="thumnail_template">
      <div class="thumbnail-item">
          <div class="thumbnail-item-wrapper">
              <span class="date">02-Feb-21</span>
              <div class="thumb-img">
                  <img src='../../App_Themes/Default/images/core-pocket/event.jpg' />
              </div>
              <div class="thumb-details">
                 <p class="font-medium text-dark thumb-name">CP Annual</>
                 <ul class="thum-list">
                     <li class="text-muted item-list">
                         <span class="icon"><i class="icon-map"></i></span>
                          <span class="text">Akshay Nagar 1st block 1st crosss Banglore-560016</span>
                     </li>
                     <li class="text-muted item-list">
                      <span class="icon"><i class="icon-clock"></i></span>
                      <span class="text">05:25 PM</span>
                     </li>
                 </ul>
                  <div class="btn-group bt-1 pt-10 text-center">
                     <a href="javascript:void(0)" class="btn btn-trans text-primary">More Details</a>
                  </div>
              </div>
          </div>
      </div>
    </script>


  <!-- #region Scripts-->

  <!-- scripts -->
  <script src="../../Scripts/Kendo/jquery.min.js"></script>
  <script src="../../Scripts/Kendo/kendo.all.min.js"></script>
  <script src="../../Scripts/CLARENT/Other/Custom/Custom.js"></script>
  <script src="../../js/UserProfile.js"></script>
  <script>

    $(document).ready(function () {
      var email = "v@gmail.com";
     

      LoadProfile(email);
      console.log(email);
      console.log("Before loading profile...");
      function LoadProfile(email) {
        console.log("Loading profile..." + email);
        $.ajax({
          url: "http://localhost:5112/api/UserProfileApi/getuserdata?email=" + email,
          method: "GET",
          success: function (data) {
            console.log(data);
            if (data != null) {
              console.log("data is not null");
              $("#userid").val(data.c_userid);

              $("#lblusername").text(data.c_UserName);
              $("#lblusername1").text(data.c_UserName);
              $("#lblemail").text(data.c_Email);
              $("#lblmobile").text(data.c_Mobile);
              $("#lblrole").text(data.c_Role);
              $("#lbladdress").text(data.c_Address);
              $("#lblgender").text(data.c_Gender);

              $("#txtuname").val(data.c_email);
              $("#txtfname").val(data.c_fname);
              $("#txtlname").val(data.c_lname);
              $("#txtemail").val(data.c_email);
              $("#txtmobile").val(data.c_mobileno);
              // Updating profile image if available
              if (data.c_userprofile) {
                $(".ImgDiv").css("display", "block");
                $(".profileLetterDiv").css("display", "none");
                $("#ViewProfileImage").attr('src', '/photo/' + data.c_userprofile);
                $("#EditProfileImage").attr('src', '/photo/' + data.c_userprofile);
              } else {
                $(".ImgDiv").css("display", "block");
                $(".profileLetterDiv").css("display", "none");
                var defaultImagePath = "/LogoImage/image.png"; // Path relative to your application's URL
                $("#ViewProfileImage").attr('src', defaultImagePath);
                $("#EditProfileImage").attr('src', defaultImagePath);

              }

            } else {
              console.log("User profile data not found.");
            }
          },
          error: function (err) {
            console.log("Error fetching user profile data:", err);
          }
        });
      }


      console.log("After loading profile...");




      setTimeout(function () {
        $("#load_screen").hide();
      }, 3000);

      $("select:not([multiple])").kendoDropDownList();

      $("#UserRoleDropdown").kendoDropDownList({
        popup: {
          appendTo: $(".userprofile-menu"),
        },
      });
      //Kendo File Upload
      $("#fileProfileImage").kendoUpload({
        showFileList: false,
        multiple: false,
        localization: { select: "Select File" },
      });

      $("#tabstrip").kendoTabStrip({
        animation: {
          open: {
            effects: "fadeIn",
          },
        },
      });

      $("#borederTabstrip").kendoTabStrip({
        animation: {
          open: {
            effects: "fadeIn",
          },
        },
      });

      var dataSource = new kendo.data.DataSource({
        transport: {
          read: {
            url: "https://demos.telerik.com/kendo-ui/service/Products",
            dataType: "jsonp",
          },
        },
      });

      $("#thumbnail_grid").kendoListView({
        dataSource: dataSource,
        selectable: "multiple",
        template: kendo.template($("#thumnail_template").html()),
      });
    });
    $("#taskList").kendoGrid({
      dataSource: {
        transport: {
            read: {
                url: "http://localhost:5112/api/tasks/GetTaskByUserId/1",  // 🔹 Replace with your API endpoint
                dataType: "json" // Expect JSON response
            }
        },
        schema: {
            model: {
                fields: {
                    c_Taskid: { type: "number" },
                    c_Title: { type: "string" },
                    c_Description: { type: "string" },
                    c_Estimateddays: { type: "number" },
                    c_Startdate: { type: "date" },
                    c_Enddate: { type: "date" },
                    c_Status: { type: "string" }
                }
            }
        },
        pageSize: 4
    },
    height: 400,
    pageable: true,
    sortable: true,
    filterable: true,
    columns: [
        { field: "c_Title", title: "Title", width: "100px" },
        { field: "c_Description", title: "Description", width: "80px" },
        { field: "c_Estimateddays", title: "Estimated Days", width: "200px" },
        { field: "c_Startdate", title: "Start Date", width: "200px", format: "{0:MM/dd/yyyy}" },
        { field: "c_Enddate", title: "End Date", width: "200px", format: "{0:MM/dd/yyyy}" },
        { field: "c_Status", title: "Status", width: "200px", template: "#= c_Status == 'Completed' ? '✅ Done' : '⏳ Pending' #" },
        {
            title: "Mark As Done",
            template: `<button class='k-button k-button-solid-error' onclick='UpdateStatus(#=c_Taskid#,#=c_Userid#)'>✔ Complete</button>`,
            width: 150
        }
    ]
  });
  function UpdateStatus(taskid,userid)
  {
    console.log(taskid);
    $.ajax({
      url: "http://localhost:5112/api/tasks/UpdateStatus/" + taskid + "/" + userid,
      type: "GET",
      contentType:false,
      processData:false,
      success:function(response)
      {
        window.location.reload();
      },
      error: function (xhr, status, error) {
        console.log("there was some error while Updating status");
      }
    });
  };
  </script>
</body>
</html>